<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Visualising uncertainty in a cardiac LV model</title><script type="text/javascript" src="elm-runtime.js"></script><script type="text/javascript">Elm.Native.Graphics.Slider=function(elm){"use strict";elm.Native=elm.Native||{};elm.Native.Graphics=elm.Native.Graphics||{};if(elm.Native.Graphics.Slider!=null)return elm.Native.Graphics.Slider;var Signal=Elm.Signal(elm),newElement=Elm.Graphics.Element(elm).newElement,Tuple2=Elm.Native.Utils(elm).Tuple2,pendingSliders=[],jqReady=false
function jqready(){jqReady=true;processSliderQueue()}
function processSliderQueue(){if(!jqReady)return;for(var i in pendingSliders){var jqel=$(pendingSliders[i].element);if(pendingSliders[i].events!=null)(function(){var events=pendingSliders[i].events.id;pendingSliders[i].model.change=function(e,ui){elm.notify(events,ui.value)}})();jqel.slider(pendingSliders[i].model)};pendingSliders=[]};var jq=Elm.Native.JQuery(elm);jq.subscribejQueryReady(jqready)
function renderSlider(events){return function(model){var slider=document.createElement('div');pendingSliders.push({model:model,element:slider,events:events});processSliderQueue();return slider}}
function updateSlider(slider,oldModel,newModel){if(oldModel==newModel)return;var changeModel={};if(oldModel.min!=newModel.min)changeModel.min=newModel.min;if(oldModel.max!=newModel.max)changeModel.max=newModel.max;if(oldModel.step!=newModel.step)changeModel.step=newModel.step;if(oldModel.value!=newModel.value)changeModel.value=newModel.value;pendingSliders.push({model:changeModel,element:slider});processSliderQueue();return false}
function slider(w,h,min,max,step,defaultValue){var events=Signal.constant(defaultValue),elem=A3(newElement,w,h,{ctor:'Custom',type:'Slider',render:renderSlider(events),update:updateSlider,props:{},model:{w:w,h:h,min:min,max:max,step:step,value:defaultValue}});return Tuple2(Signal.constant(elem),events)};return elm.Native.Graphics.Slider={slider:F6(slider)}};Elm.Native.JQuery=function(elm){"use strict";elm.Native=elm.Native||{};if(elm.Native.JQuery)return elm.Native.JQuery;var count=0,jqueryUsers=[]
function subscribejQueryReady(f){jqueryUsers.push(f)}
function jqueryLoaded(){count++;if(count!=2)return;for(var i in jqueryUsers)jqueryUsers[i]()};var cse=document.createElement("link");cse.setAttribute("rel","stylesheet");cse.setAttribute("type","text/css");cse.setAttribute("href","http://code.jquery.com/ui/1.10.3/themes/ui-lightness/jquery-ui.min.css");document.head.appendChild(cse);var scr=document.createElement("script");scr.setAttribute("src","http://code.jquery.com/jquery-1.10.2.min.js");scr.setAttribute("type","text/javascript");scr.onload=jqueryLoaded;document.head.appendChild(scr);scr=document.createElement("script");scr.setAttribute("src","http://code.jquery.com/ui/1.10.3/jquery-ui.min.js");scr.setAttribute("type","text/javascript");scr.onload=jqueryLoaded;document.head.appendChild(scr);return elm.Native.JQuery={subscribejQueryReady:subscribejQueryReady}};Elm.Native.FastJSON=function(elm){"use strict";elm.Native=elm.Native||{};if(elm.Native.FastJSON)return elm.Native.FastJSON;var NJS=Elm.Native.JavaScript(elm),JS=Elm.JavaScript(elm),List=Elm.List(elm),Signal=Elm.Signal(elm)
function registerReq(queue,responses){return function(req){if(req.url.ctor!=='[]')sendReq(queue,responses,req)}}
function updateQueue(queue,responses){if(queue.length>0){elm.notify(responses.id,queue[0].value);if(queue[0].value.ctor!=='Waiting'){queue.shift();setTimeout(function(){updateQueue(queue,responses)},0)}}}
function setHeader(pair){request.setRequestHeader(JS.fromString(pair._0),JS.fromString(pair._1))}
function sendReq(queue,responses,req){var response={value:{ctor:'Waiting'}};queue.push(response);var request=null;if(window.ActiveXObject)request=new ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)request=new XMLHttpRequest();request.onreadystatechange=function(e){if(request.readyState===4){response.value=(request.status>=200&&request.status<300?{ctor:'Success',_0:(request.responseText)}:{ctor:'Failure',_0:request.status,_1:JS.toString(request.statusText)});setTimeout(function(){updateQueue(queue,responses)},0)}};request.open(JS.fromString(req.verb),JS.fromString(req.url),true);List.map(setHeader)(req.headers);request.send(JS.fromString(req.body))}
function send(requests){var responses=Signal.constant(elm.Http.Waiting),sender=A2(Signal.lift,registerReq([],responses),requests)
function f(x){return function(y){return x}};return A3(Signal.lift2,f,responses,sender)}
function fastJSON(str){return window.JSON.parse(str)}
function rawLookup(arr,idx){return arr[idx]}
function simpleRemapArray(remap,glob){var loc=[];for(var i in remap)loc[remap[i].loc-1]=glob[remap[i].glob-1];return loc}
function linearRemapArray(remap,glob){var loc=[];for(var i in remap){var newloc=0.0;for(var j in remap[i].globs)newloc+=remap[i].globs[j].mup*glob[remap[i].globs[j].glob-1];glob[remap[i].glob];loc[remap[i].loc-1]=newloc};return loc}
function linearCombine(parts){parts=NJS.fromList(parts);var accum=parts[0].values.map(function(x){return x*parts[0].mup});for(var i in parts){if(i==0)continue;for(var j in parts[i].values)accum[j]+=parts[i].mup*parts[i].values[j]};return accum}
function trilinearInterpolate(f,xi){var result=0.0;xi=xi._0;var basisTable=[[1-xi._0,xi._0],[1-xi._1,xi._1],[1-xi._2,xi._2]];for(var i=0;i<2;i++)for(var j=0;j<2;j++)for(var k=0;k<2;k++)result+=basisTable[0][i]*basisTable[1][j]*basisTable[2][k]*f({ctor:"TrilinearLocalNode",_0:i+j*2+k*4+1});return result}
function bicubicLinearInterpolate(f,xi){var result=0.0;xi=xi._0;var xi0_2=xi._0*xi._0,xi0_3=xi0_2*xi._0,xi1_2=xi._1*xi._1,xi1_3=xi1_2*xi._1,basisTable=[[1-3*xi._0+3*xi0_2-xi0_3,3*xi._0-6*xi0_2+3*xi0_3,3*xi0_2-3*xi0_3,xi0_3],[1-3*xi._1+3*xi1_2-xi1_3,3*xi._1-6*xi1_2+3*xi1_3,3*xi1_2-3*xi1_3,xi1_3],[1-xi._2,xi._2]];for(var i=0;i<4;i++)for(var j=0;j<4;j++)for(var k=0;k<2;k++)result+=basisTable[0][i]*basisTable[1][j]*basisTable[2][k]*f({ctor:"BicubicLinearLocalNode",_0:i+j*4+k*16+1});return result};return elm.Native.FastJSON={fastJSON:fastJSON,rawLookup:F2(rawLookup),send:send,simpleRemapArray:F2(simpleRemapArray),linearRemapArray:F2(linearRemapArray),bicubicLinearInterpolate:F2(bicubicLinearInterpolate),trilinearInterpolate:F2(trilinearInterpolate),linearCombine:linearCombine}};Elm.Native.Graphics.WebGLScene=function(elm){"use strict";var Render=ElmRuntime.use(ElmRuntime.Render.Element),JS=Elm.JavaScript(elm),D=Elm.Dict(elm);elm.Native=elm.Native||{};elm.Native.Graphics=elm.Native.Graphics||{};if(elm.Native.Graphics.WebGLScene)return elm.Native.Graphics.WebGLScene;var vertexShader="attribute mediump vec3 aPos;\
                        attribute mediump vec3 aNormal;\
                        varying mediump vec3 normal;\
                        uniform mediump mat4 aProjection;\
                        void main(void) {\
                          normal = normalize(aNormal);\
                          gl_Position = aProjection * vec4(aPos, 1.0); \
                        }",fragmentShader="varying mediump vec3 normal;\
         uniform mediump vec3 aAmbientColour, aDiffuse1Colour;\
         uniform mediump vec3 aDiffuse1Direction;\
         uniform mediump float aAmbientIntensity, aDiffuse1Intensity;\
         void main(void) {\
           mediump vec3 rgb = aAmbientColour * aAmbientIntensity +\
                      aDiffuse1Colour * aDiffuse1Intensity * \
                      clamp(dot(normal, normalize(aDiffuse1Direction)), 0.0, 1.0);\
           gl_FragColor = vec4(rgb, 1.0);\
                         }",newElement=Elm.Graphics.Element(elm).newElement
function renderGLScene(model){var jscanvas=document.createElement("canvas");jscanvas.width=model.w;jscanvas.height=model.h;newContext(jscanvas);updateGLScene(jscanvas,{w:0,h:0,model:null,projection:null},model);return jscanvas}
function newContext(jscanvas){var ctx=jscanvas.getContext("webgl")||jscanvas.getContext("experimental-webgl");ctx.viewport(0,0,500,500);var shaderProgram=ctx.createProgram();ctx.enable(ctx.DEPTH_TEST);var vertShad=ctx.createShader(ctx.VERTEX_SHADER);ctx.shaderSource(vertShad,vertexShader);ctx.compileShader(vertShad);ctx.attachShader(shaderProgram,vertShad);var fragShad=ctx.createShader(ctx.FRAGMENT_SHADER);ctx.shaderSource(fragShad,fragmentShader);ctx.compileShader(fragShad);ctx.attachShader(shaderProgram,fragShad);ctx.linkProgram(shaderProgram);ctx.useProgram(shaderProgram);var shadeData={aPos:ctx.getAttribLocation(shaderProgram,"aPos"),aNormal:ctx.getAttribLocation(shaderProgram,"aNormal"),aProjection:ctx.getUniformLocation(shaderProgram,"aProjection"),aAmbientColour:ctx.getUniformLocation(shaderProgram,"aAmbientColour"),aAmbientIntensity:ctx.getUniformLocation(shaderProgram,"aAmbientIntensity"),aDiffuse1Colour:ctx.getUniformLocation(shaderProgram,"aDiffuse1Colour"),aDiffuse1Direction:ctx.getUniformLocation(shaderProgram,"aDiffuse1Direction"),aDiffuse1Intensity:ctx.getUniformLocation(shaderProgram,"aDiffuse1Intensity")};ctx.enableVertexAttribArray(shadeData.aPos);ctx.enableVertexAttribArray(shadeData.aNormal);jscanvas.shadeData=shadeData;jscanvas.ctx=ctx;return ctx}
function updateGLScene(jscanvas,curr,next){jscanvas.width=next.w;jscanvas.height=next.h;if(jscanvas.ctx==null)return;jscanvas.ctx.viewport(0,0,next.w,next.h);var modelChanged=next.model!=curr.model,sceneChanged=next.sceneview!=curr.sceneview;if(modelChanged||sceneChanged){jscanvas.ctx.clearColor(0.0,0.0,0.0,1.0);jscanvas.ctx.clearDepth(65535);jscanvas.ctx.depthFunc(jscanvas.ctx.LESS);jscanvas.ctx.clear(jscanvas.ctx.COLOR_BUFFER_BIT|jscanvas.ctx.DEPTH_BUFFER_BIT)};var jsmodel=next.model._0;if(modelChanged){var jsprims=JS.fromList(jsmodel.primitives);jscanvas.nNodes=jsprims.length*3;var nodalPos=new Float32Array(3*jscanvas.nNodes),normals=new Float32Array(3*jscanvas.nNodes);for(var primID in jsprims){var thisPrim=jsprims[primID];nodalPos.set([thisPrim._0._0,thisPrim._0._1,thisPrim._0._2,thisPrim._1._0,thisPrim._1._1,thisPrim._1._2,thisPrim._2._0,thisPrim._2._1,thisPrim._2._2,],9*primID);var ux=thisPrim._1._0-thisPrim._0._0,uy=thisPrim._1._1-thisPrim._0._1,uz=thisPrim._1._2-thisPrim._0._2,vx=thisPrim._2._0-thisPrim._0._0,vy=thisPrim._2._1-thisPrim._0._1,vz=thisPrim._2._2-thisPrim._0._2,Nx=uy*vz-uz*vy,Ny=uz*vx-ux*vz,Nz=ux*vy-uy*vx;normals.set([Nx,Ny,Nz,Nx,Ny,Nz,Nx,Ny,Nz],9*primID)};jscanvas.ctx.bindBuffer(jscanvas.ctx.ARRAY_BUFFER,jscanvas.ctx.createBuffer());jscanvas.ctx.bufferData(jscanvas.ctx.ARRAY_BUFFER,nodalPos,jscanvas.ctx.STATIC_DRAW);jscanvas.ctx.vertexAttribPointer(jscanvas.shadeData.aPos,3,jscanvas.ctx.FLOAT,false,0,0);jscanvas.ctx.bindBuffer(jscanvas.ctx.ARRAY_BUFFER,jscanvas.ctx.createBuffer());jscanvas.ctx.bufferData(jscanvas.ctx.ARRAY_BUFFER,normals,jscanvas.ctx.STATIC_DRAW);jscanvas.ctx.vertexAttribPointer(jscanvas.shadeData.aNormal,3,jscanvas.ctx.FLOAT,false,0,0)};if(sceneChanged){var sv=next.sceneview._0;jscanvas.ctx.uniformMatrix4fv(jscanvas.shadeData.aProjection,false,[sv.projection._0._0,sv.projection._1._0,sv.projection._2._0,sv.projection._3._0,sv.projection._0._1,sv.projection._1._1,sv.projection._2._1,sv.projection._3._1,sv.projection._0._2,sv.projection._1._2,sv.projection._2._2,sv.projection._3._2,sv.projection._0._3,sv.projection._1._3,sv.projection._2._3,sv.projection._3._3]);jscanvas.ctx.uniform1f(jscanvas.shadeData.aAmbientIntensity,sv.ambientIntensity);jscanvas.ctx.uniform1f(jscanvas.shadeData.aDiffuse1Intensity,sv.diffuseIntensity);jscanvas.ctx.uniform3f(jscanvas.shadeData.aAmbientColour,sv.ambientColour._0,sv.ambientColour._1,sv.ambientColour._2);jscanvas.ctx.uniform3f(jscanvas.shadeData.aDiffuse1Colour,sv.diffuseColour._0,sv.diffuseColour._1,sv.diffuseColour._2);jscanvas.ctx.uniform3f(jscanvas.shadeData.aDiffuse1Direction,sv.diffuseDirection._0,sv.diffuseDirection._1,sv.diffuseDirection._2)};if(modelChanged||sceneChanged){jscanvas.ctx.drawArrays(jscanvas.ctx.TRIANGLES,0,jscanvas.nNodes);jscanvas.ctx.flush()};return false}
function glSceneObject(w,h,model,sceneview){return A3(newElement,w,h,{ctor:'Custom',type:'WebGL',render:renderGLScene,update:updateGLScene,props:{},model:{w:w,h:h,model:model,sceneview:sceneview}})};return elm.Native.Graphics.WebGLScene={glSceneObject:F4(glSceneObject)}};Elm.Main=function(elm){var N=Elm.Native,_N=N.Utils(elm),_L=N.List(elm),_E=N.Error(elm),_J=N.JavaScript(elm),_str=_J.toString,$op={},_=Elm.Text(elm),Text=_,hiding={link:1,color:1,height:1};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Prelude(elm),Prelude=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Signal(elm),Signal=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.List(elm),List=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Maybe(elm),Maybe=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Time(elm),Time=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Graphics.Element(elm),Graphics=Graphics||{};Graphics.Element=_;var hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Color(elm),Color=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Graphics.Collage(elm),Graphics=Graphics||{};Graphics.Collage=_;var hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var N=Elm.Native.Graphics.WebGLScene(elm),NJSON=Elm.Native.FastJSON(elm),_=Elm.Dict(elm),Dict=_,_=Elm.Mouse(elm),Mouse=_,_=Elm.Keyboard(elm),Keyboard=_,_=Elm.Touch(elm),Touch=_,_=Elm.Http(elm),Http=_,Success=_.Success,Waiting=_.Waiting,Failure=_.Failure,_=Elm.Json(elm),Json=_,_=Elm.JavaScript.Experimental(elm),JavaScript=JavaScript||{};JavaScript.Experimental=_;var _=Elm.Graphics.Input(elm),Graphics=Graphics||{};Graphics.Input=_;var dropDown=_.dropDown,_=Elm.JavaScript(elm),JavaScript=_,fromList=_.fromList,toList=_.toList,fromString=_.fromString,_=Elm.Native.JQuery(elm),Native=Native||{};Native.JQuery=_;var NSLIDE=Elm.Native.Graphics.Slider(elm),Coord3D_0=F3(function(a1,a2,a3){return {ctor:"Coord3D",_0:a1,_1:a2,_2:a3}}),Triangle_1=F3(function(a1,a2,a3){return {ctor:"Triangle",_0:a1,_1:a2,_2:a3}}),GLColour_2=F3(function(a1,a2,a3){return {ctor:"GLColour",_0:a1,_1:a2,_2:a3}}),Vector4_3=F4(function(a1,a2,a3,a4){return {ctor:"Vector4",_0:a1,_1:a2,_2:a3,_3:a4}}),Matrix4x4_4=F4(function(a1,a2,a3,a4){return {ctor:"Matrix4x4",_0:a1,_1:a2,_2:a3,_3:a4}}),Vector3_5=F3(function(a1,a2,a3){return {ctor:"Vector3",_0:a1,_1:a2,_2:a3}}),Quaternion_6=F4(function(a1,a2,a3,a4){return {ctor:"Quaternion",_0:a1,_1:a2,_2:a3,_3:a4}}),GLPrimModel_7=function(a1){return {ctor:"GLPrimModel",_0:a1}},GLPrimSceneView_8=function(a1){return {ctor:"GLPrimSceneView",_0:a1}},TranslateXY_44={ctor:"TranslateXY"},TranslateXZ_45={ctor:"TranslateXZ"},CameraRotate_46={ctor:"CameraRotate"},CameraTranslate_47=function(a1){return {ctor:"CameraTranslate",_0:a1}},DETERMINE_55={ctor:"DETERMINE"},MESA_56={ctor:"MESA"},EndDiastole_57={ctor:"EndDiastole"},EndSystole_58={ctor:"EndSystole"},AverageState_59={ctor:"AverageState"},GlobalMuLambda_63=function(a1){return {ctor:"GlobalMuLambda",_0:a1}},GlobalTheta_64=function(a1){return {ctor:"GlobalTheta",_0:a1}},ElementID_65=function(a1){return {ctor:"ElementID",_0:a1}},BicubicLinearLocalNode_66=function(a1){return {ctor:"BicubicLinearLocalNode",_0:a1}},TrilinearLocalNode_67=function(a1){return {ctor:"TrilinearLocalNode",_0:a1}},Endocardial_68={ctor:"Endocardial"},Epicardial_69={ctor:"Epicardial"},RefinedNodeID_70=function(a1){return {ctor:"RefinedNodeID",_0:a1}},Prolate_71=function(a1){return {ctor:"Prolate",_0:a1}},Xi_72=function(a1){return {ctor:"Xi",_0:a1}},vec4ToXYZ_20=function(_84000_103){return function(){switch(_84000_103.ctor){case'Vector4':return A3(Vector3_5,_84000_103._0,_84000_103._1,_84000_103._2)};_E.Case('Line 84, Column 31')}()},matrix4x4Row_21=F2(function(row_107,_92000_108){return function(){switch(_92000_108.ctor){case'Matrix4x4':return function(){switch(row_107){case 0:return _92000_108._0;case 1:return _92000_108._1;case 2:return _92000_108._2;case 3:return _92000_108._3};_E.Case('Line 88, Column 3')}()};_E.Case('Line 88, Column 3')}()}),matrix4x4Column_22=F2(function(row_113,_103000_114){return function(){switch(_103000_114.ctor){case'Matrix4x4':switch(_103000_114._0.ctor){case'Vector4':switch(_103000_114._1.ctor){case'Vector4':switch(_103000_114._2.ctor){case'Vector4':switch(_103000_114._3.ctor){case'Vector4':return function(){switch(row_113){case 0:return A4(Vector4_3,_103000_114._0._0,_103000_114._1._0,_103000_114._2._0,_103000_114._3._0);case 1:return A4(Vector4_3,_103000_114._0._1,_103000_114._1._1,_103000_114._2._1,_103000_114._3._1);case 2:return A4(Vector4_3,_103000_114._0._2,_103000_114._1._2,_103000_114._2._2,_103000_114._3._2);case 3:return A4(Vector4_3,_103000_114._0._3,_103000_114._1._3,_103000_114._2._3,_103000_114._3._3)};_E.Case('Line 99, Column 3')}()};break};break};break};break};_E.Case('Line 99, Column 3')}()}),dotProduct_23=F2(function(_107001_131,_107000_132){return function(){switch(_107001_131.ctor){case'Vector4':return function(){switch(_107000_132.ctor){case'Vector4':return((((_107001_131._0*_107000_132._0)+(_107001_131._1*_107000_132._1))+(_107001_131._2*_107000_132._2))+(_107001_131._3*_107000_132._3))};_E.Case('Line 107, Column 4')}()};_E.Case('Line 107, Column 4')}()}),multiply4x4_24=F2(function(m1_141,m2_142){return function(){var p_143=F2(function(r_144,c_145){return A2(dotProduct_23,A2(matrix4x4Row_21,r_144,m1_141),A2(matrix4x4Column_22,c_145,m2_142))});return A4(Matrix4x4_4,A4(Vector4_3,A2(p_143,0,0),A2(p_143,0,1),A2(p_143,0,2),A2(p_143,0,3)),A4(Vector4_3,A2(p_143,1,0),A2(p_143,1,1),A2(p_143,1,2),A2(p_143,1,3)),A4(Vector4_3,A2(p_143,2,0),A2(p_143,2,1),A2(p_143,2,2),A2(p_143,2,3)),A4(Vector4_3,A2(p_143,3,0),A2(p_143,3,1),A2(p_143,3,2),A2(p_143,3,3)))}()}),mat4x4xv_25=F2(function(m_146,v_147){return A4(Vector4_3,A2(dotProduct_23,A2(matrix4x4Row_21,0,m_146),v_147),A2(dotProduct_23,A2(matrix4x4Row_21,1,m_146),v_147),A2(dotProduct_23,A2(matrix4x4Row_21,2,m_146),v_147),A2(dotProduct_23,A2(matrix4x4Row_21,3,m_146),v_147))}),transpose4x4_26=function(_134000_148){return function(){switch(_134000_148.ctor){case'Matrix4x4':switch(_134000_148._0.ctor){case'Vector4':switch(_134000_148._1.ctor){case'Vector4':switch(_134000_148._2.ctor){case'Vector4':switch(_134000_148._3.ctor){case'Vector4':return A4(Matrix4x4_4,A4(Vector4_3,_134000_148._0._0,_134000_148._1._0,_134000_148._2._0,_134000_148._3._0),A4(Vector4_3,_134000_148._0._1,_134000_148._1._1,_134000_148._2._1,_134000_148._3._1),A4(Vector4_3,_134000_148._0._2,_134000_148._1._2,_134000_148._2._2,_134000_148._3._2),A4(Vector4_3,_134000_148._0._3,_134000_148._1._3,_134000_148._2._3,_134000_148._3._3))};break};break};break};break};_E.Case('Line 131, Column 3')}()},norm4_27=function(_137000_165){return function(){switch(_137000_165.ctor){case'Vector4':return A3(Vector3_5,(_137000_165._0/_137000_165._3),(_137000_165._1/_137000_165._3),(_137000_165._2/_137000_165._3))};_E.Case('Line 137, Column 31')}()},mat4ToInverseMat3_28=function(_157000_170){return function(){switch(_157000_170.ctor){case'Matrix4x4':switch(_157000_170._0.ctor){case'Vector4':switch(_157000_170._1.ctor){case'Vector4':switch(_157000_170._2.ctor){case'Vector4':switch(_157000_170._3.ctor){case'Vector4':return function(){var b12_187=((_157000_170._2._2*_157000_170._1._1)-(_157000_170._1._2*_157000_170._2._1)),b22_188=((_157000_170._1._2*_157000_170._2._0)-(_157000_170._2._2*_157000_170._1._0)),b32_189=((_157000_170._2._1*_157000_170._1._0)-(_157000_170._1._1*_157000_170._2._0)),det_190=(((_157000_170._0._0*b12_187)+(_157000_170._0._1*b22_188))+(_157000_170._0._2*b32_189)),invDet_191=(_N.eq(det_190,0)?0:(1/det_190));return A4(Matrix4x4_4,A4(Vector4_3,(b12_187*invDet_191),(((_157000_170._0._2*_157000_170._2._1)-(_157000_170._2._2*_157000_170._0._1))*invDet_191),(((_157000_170._1._2*_157000_170._0._1)-(_157000_170._0._2*_157000_170._1._1))*invDet_191),0),A4(Vector4_3,(b22_188*invDet_191),(((_157000_170._2._2*_157000_170._0._0)-(_157000_170._0._2*_157000_170._2._0))*invDet_191),(((_157000_170._0._2*_157000_170._1._0)-(_157000_170._1._2*_157000_170._0._0))*invDet_191),0),A4(Vector4_3,(b32_189*invDet_191),(((_157000_170._0._1*_157000_170._2._0)-(_157000_170._2._1*_157000_170._0._0))*invDet_191),(((_157000_170._1._1*_157000_170._0._0)-(_157000_170._0._1*_157000_170._1._0))*invDet_191),0),A4(Vector4_3,0,0,0,1))}()};break};break};break};break};_E.Case('Line 146, Column 3')}()},quaternionToRotationMatrix_29=function(_163000_192){return function(){switch(_163000_192.ctor){case'Quaternion':return A4(Matrix4x4_4,A4(Vector4_3,(1-(2*((_163000_192._2*_163000_192._2)+(_163000_192._3*_163000_192._3)))),(2*((_163000_192._1*_163000_192._2)+(_163000_192._0*_163000_192._3))),(2*((_163000_192._1*_163000_192._3)-(_163000_192._0*_163000_192._2))),0),A4(Vector4_3,(2*((_163000_192._1*_163000_192._2)-(_163000_192._0*_163000_192._3))),(1-(2*((_163000_192._1*_163000_192._1)+(_163000_192._3*_163000_192._3)))),(2*((_163000_192._2*_163000_192._3)+(_163000_192._0*_163000_192._1))),0),A4(Vector4_3,(2*((_163000_192._1*_163000_192._3)+(_163000_192._0*_163000_192._2))),(2*((_163000_192._2*_163000_192._3)-(_163000_192._0*_163000_192._1))),(1-(2*((_163000_192._1*_163000_192._1)+(_163000_192._2*_163000_192._2)))),0),A4(Vector4_3,0,0,0,1))};_E.Case('Line 160, Column 3')}()},normaliseQuaternion_30=function(_169000_197){return function(){switch(_169000_197.ctor){case'Quaternion':return function(){var norm_202=sqrt(((((_169000_197._0*_169000_197._0)+(_169000_197._1*_169000_197._1))+(_169000_197._2*_169000_197._2))+(_169000_197._3*_169000_197._3)));return A4(Quaternion_6,(_169000_197._0/norm_202),(_169000_197._1/norm_202),(_169000_197._2/norm_202),(_169000_197._3/norm_202))}()};_E.Case('Line 166, Column 3')}()},multiplyQuaternion_31=F2(function(_175001_203,_175000_204){return function(){switch(_175001_203.ctor){case'Quaternion':return function(){switch(_175000_204.ctor){case'Quaternion':return A4(Quaternion_6,((((_175001_203._0*_175000_204._0)-(_175001_203._1*_175000_204._1))-(_175001_203._2*_175000_204._2))-(_175001_203._3*_175000_204._3)),((((_175001_203._2*_175000_204._3)-(_175001_203._3*_175000_204._2))+(_175001_203._0*_175000_204._1))+(_175000_204._0*_175001_203._1)),((((_175001_203._3*_175000_204._1)-(_175001_203._1*_175000_204._3))+(_175001_203._0*_175000_204._2))+(_175000_204._0*_175001_203._2)),((((_175001_203._1*_175000_204._2)-(_175001_203._2*_175000_204._1))+(_175001_203._0*_175000_204._3))+(_175001_203._3*_175000_204._0)))};_E.Case('Line 172, Column 3')}()};_E.Case('Line 172, Column 3')}()}),conjugateQuaternion_32=function(_176000_213){return function(){switch(_176000_213.ctor){case'Quaternion':return A4(Quaternion_6,_176000_213._0,(0-_176000_213._1),(0-_176000_213._2),(0-_176000_213._3))};_E.Case('Line 176, Column 44')}()},rotateVectorByQuaternion_33=F2(function(q_218,_184000_219){return function(){switch(_184000_219.ctor){case'Vector3':return function(){var _182000_223=A2(multiplyQuaternion_31,q_218,A2(multiplyQuaternion_31,A4(Quaternion_6,0,_184000_219._0,_184000_219._1,_184000_219._2),conjugateQuaternion_32(q_218))),x$_224=function(){switch(_182000_223.ctor){case'Quaternion':return _182000_223._1};_E.Case('Line 182, Column 7')}(),y$_225=function(){switch(_182000_223.ctor){case'Quaternion':return _182000_223._2};_E.Case('Line 182, Column 7')}(),z$_226=function(){switch(_182000_223.ctor){case'Quaternion':return _182000_223._3};_E.Case('Line 182, Column 7')}();return A3(Vector3_5,x$_224,y$_225,z$_226)}()};_E.Case('Line 180, Column 3')}()}),eulerToQuaternion_34=F3(function(theta_236,phi_237,psi_238){return function(){var theta2_239=(theta_236/2),phi2_240=(phi_237/2),psi2_241=(psi_238/2),costheta2_242=cos(theta2_239),sintheta2_243=sin(theta2_239),cosphi2_244=cos(phi2_240),sinphi2_245=sin(phi2_240),cospsi2_246=cos(psi2_241),sinpsi2_247=sin(psi2_241);return A4(Quaternion_6,(((cospsi2_246*costheta2_242)*cosphi2_244)+((sinpsi2_247*costheta2_242)*cosphi2_244)),(((sinpsi2_247*costheta2_242)*cosphi2_244)-((cospsi2_246*sintheta2_243)*sinphi2_245)),(((cospsi2_246*sintheta2_243)*cosphi2_244)+((sinpsi2_247*costheta2_242)*sinphi2_245)),(((cospsi2_246*costheta2_242)*sinphi2_245)-((sinpsi2_247*sintheta2_243)*cosphi2_244)))}()}),vectorToTranslationMatrix_35=function(_207000_248){return function(){switch(_207000_248.ctor){case'Vector3':return A4(Matrix4x4_4,A4(Vector4_3,1,0,0,_207000_248._0),A4(Vector4_3,0,1,0,_207000_248._1),A4(Vector4_3,0,0,1,_207000_248._2),A4(Vector4_3,0,0,0,1))};_E.Case('Line 204, Column 3')}()},perspectiveMatrix_42=F4(function(near_265,far_266,aspectRatio_267,fovRadians_268){return function(){var f_269=(1.0/tan((fovRadians_268/2))),nf_270=(1/(near_265-far_266));return A4(Matrix4x4_4,A4(Vector4_3,(f_269/aspectRatio_267),0,0,0),A4(Vector4_3,0,f_269,0,0),A4(Vector4_3,0,0,((far_266+near_265)*nf_270),(((2*far_266)*near_265)*nf_270)),A4(Vector4_3,0,0,-1,0))}()}),CameraMoveState_48=F6(function(cameraQuaternion_271,cameraTransformation_272,processedPosition_273,mainTouch_274,wasDragging_275,cameraModifyMode_276){return {_:{},cameraModifyMode:cameraModifyMode_276,cameraQuaternion:cameraQuaternion_271,cameraTransformation:cameraTransformation_272,mainTouch:mainTouch_274,processedPosition:processedPosition_273,wasDragging:wasDragging_275}}),keyboardAlt_50=function(keysDown_277){return A2(any,function(x_278){return _N.eq(x_278,18)},keysDown_277)},updateCameraMoveState_53=F2(function(_339000_284,oldMoveState_285){return function(){switch(_339000_284.ctor){case'Tuple4':return function(){var dragging_290=(_N.cmp(length(_339000_284._3),0).ctor==='GT');return(not(dragging_290)?_N.replace([['wasDragging',false]],oldMoveState_285):function(){var newCameraModifyMode_291=((_339000_284._0||_N.eq(length(_339000_284._3),2))?CameraTranslate_47(TranslateXY_44):((_339000_284._1||(keyboardAlt_50(_339000_284._2)||(_N.cmp(length(_339000_284._3),2).ctor==='GT')))?CameraTranslate_47(TranslateXZ_45):CameraRotate_46));return(not(oldMoveState_285.wasDragging)?function(){var pointer_292=head(_339000_284._3);return _N.replace([['wasDragging',true],['processedPosition',{ctor:"Tuple2",_0:pointer_292.x,_1:pointer_292.y}],['mainTouch',head(_339000_284._3)],['cameraModifyMode',newCameraModifyMode_291]],oldMoveState_285)}():function(){var previousPointCatcher_293=A2(filter,function(t_298){return _N.eq(t_298.id,oldMoveState_285.mainTouch.id)},_339000_284._3),pointer_294=((_N.cmp(length(previousPointCatcher_293),0).ctor==='GT')?head(previousPointCatcher_293):head(_339000_284._3)),_303000_295=oldMoveState_285.processedPosition,lastX_296=function(){switch(_303000_295.ctor){case'Tuple2':return _303000_295._0};_E.Case('Line 303, Column 34')}(),lastY_297=function(){switch(_303000_295.ctor){case'Tuple2':return _303000_295._1};_E.Case('Line 303, Column 34')}();return function(){var case149=oldMoveState_285.cameraModifyMode;switch(case149.ctor){case'CameraRotate':return function(){var x_303=((2*(toFloat(pointer_294.x)/toFloat(canvasWidth_75)))-1),y_304=((2*(toFloat(pointer_294.y)/toFloat(canvasHeight_76)))-1),modPositionVector_305=sqrt(((x_303*x_303)+(y_304*y_304))),xChange_306=((2*toFloat((lastX_296-pointer_294.x)))/toFloat(canvasWidth_75)),yChange_307=((2*toFloat((lastY_297-pointer_294.y)))/toFloat(canvasHeight_76)),modChangeVector_308=sqrt(((xChange_306*xChange_306)+(yChange_307*yChange_307))),alpha_309=(((_N.cmp(modChangeVector_308,0).ctor==='GT')&&(_N.cmp(modPositionVector_305,0).ctor==='GT'))?((abs(((x_303*xChange_306)+(y_304*yChange_307)))/modChangeVector_308)/modPositionVector_305):1.0),phi_310=(alpha_309*xChange_306),theta_311=(alpha_309*yChange_307),psi_312=((y_304*xChange_306)-(x_303*yChange_307)),rotQuaternion_313=A3(eulerToQuaternion_34,phi_310,psi_312,theta_311);return _N.replace([['cameraQuaternion',normaliseQuaternion_30(multiplyQuaternion_31(oldMoveState_285.cameraQuaternion)(rotQuaternion_313))],['processedPosition',{ctor:"Tuple2",_0:pointer_294.x,_1:pointer_294.y}],['cameraModifyMode',newCameraModifyMode_291],['mainTouch',pointer_294]],oldMoveState_285)}();case'CameraTranslate':return function(){var distanceX_315=((toFloat((pointer_294.x-lastX_296))/toFloat(canvasWidth_75))*50),distanceY_316=((toFloat((pointer_294.y-lastY_297))/toFloat(canvasHeight_76))*50),translateBy_317=function(){switch(case149._0.ctor){case'TranslateXY':return {ctor:"Tuple3",_0:distanceX_315,_1:(0-distanceY_316),_2:0};case'TranslateXZ':return {ctor:"Tuple3",_0:distanceX_315,_1:0,_2:distanceY_316}};_E.Case('Line 331, Column 37')}(),_334000_318=oldMoveState_285.cameraTransformation,otx_319=function(){switch(_334000_318.ctor){case'Vector3':return _334000_318._0};_E.Case('Line 334, Column 45')}(),oty_320=function(){switch(_334000_318.ctor){case'Vector3':return _334000_318._1};_E.Case('Line 334, Column 45')}(),otz_321=function(){switch(_334000_318.ctor){case'Vector3':return _334000_318._2};_E.Case('Line 334, Column 45')}(),_335000_322=translateBy_317,tx_323=function(){switch(_335000_322.ctor){case'Tuple3':return _335000_322._0};_E.Case('Line 335, Column 39')}(),ty_324=function(){switch(_335000_322.ctor){case'Tuple3':return _335000_322._1};_E.Case('Line 335, Column 39')}(),tz_325=function(){switch(_335000_322.ctor){case'Tuple3':return _335000_322._2};_E.Case('Line 335, Column 39')}();return _N.replace([['cameraTransformation',A3(Vector3_5,(otx_319+tx_323),(oty_320+ty_324),(otz_321+tz_325))],['processedPosition',{ctor:"Tuple2",_0:pointer_294.x,_1:pointer_294.y}],['cameraModifyMode',newCameraModifyMode_291],['mainTouch',pointer_294]],oldMoveState_285)}()};_E.Case('Line 305, Column 17')}()}())}())}()};_E.Case('Line 283, Column 3')}()}),LVDistrib_60=F7(function(dataset_345,coordScheme_346,analysis_347,biologicalState_348,components_349,averages_350,modes_351){return {_:{},analysis:analysis_347,averages:averages_350,biologicalState:biologicalState_348,components:components_349,coordScheme:coordScheme_346,dataset:dataset_345,modes:modes_351}}),LVJSON_61=F3(function(localToGlobalMuTheta_352,localToGlobalLambda_353,distributions_354){return {_:{},distributions:distributions_354,localToGlobalLambda:localToGlobalLambda_353,localToGlobalMuTheta:localToGlobalMuTheta_352}}),responseToLVJSON_62=function(resp_355){return function(){switch(resp_355.ctor){case'Failure':return Nothing;case'Success':return Just(fastJSON_11(resp_355._0));case'Waiting':return Nothing};_E.Case('Line 366, Column 3')}()},surfaceToFloat_79=function(x_357){return function(){switch(x_357.ctor){case'Endocardial':return 0;case'Epicardial':return 1};_E.Case('Line 412, Column 20')}()},localNodeIndexBicubicLinear_83=F2(function(_422001_358,_422000_359){return function(){switch(_422001_358.ctor){case'BicubicLinearLocalNode':return function(){switch(_422000_359.ctor){case'ElementID':return((((_422000_359._0-1)*nBicubicLinearLocalNodes_81)+(_422001_358._0-1))+1)};_E.Case('Line 422, Column 4')}()};_E.Case('Line 422, Column 4')}()}),localNodeIndexTrilinear_84=F2(function(_426001_362,_426000_363){return function(){switch(_426001_362.ctor){case'TrilinearLocalNode':return function(){switch(_426000_363.ctor){case'ElementID':return((((_426000_363._0-1)*nTrilinearLocalNodes_82)+(_426001_362._0-1))+1)};_E.Case('Line 426, Column 4')}()};_E.Case('Line 426, Column 4')}()}),refinedNodeToXiCoordinates_88=F2(function(_446000_366,surf_367){return function(){switch(_446000_366.ctor){case'RefinedNodeID':return function(){var rnid0_369=(_446000_366._0-1),col_370=A2(mod,rnid0_369,refineX_73),row_371=A2(div,_446000_366._0,refineX_73);return Xi_72({ctor:"Tuple3",_0:(toFloat(col_370)*(1/toFloat((refineX_73-1)))),_1:(toFloat(row_371)*(1/toFloat((refineY_74-1)))),_2:surfaceToFloat_79(surf_367)})}()};_E.Case('Line 439, Column 3')}()}),cosh_89=function(x_372){return((exp(x_372)+exp((0-x_372)))*0.5)},sinh_90=function(x_373){return((exp(x_373)-exp((0-x_373)))*0.5)},prolateToCartesian_91=F2(function(focalLength_374,_457000_375){return function(){switch(_457000_375.ctor){case'Prolate':return A3(Coord3D_0,((focalLength_374*cosh_89(_457000_375._0.lambda))*cos(_457000_375._0.mu)),(((focalLength_374*sinh_90(_457000_375._0.lambda))*sin(_457000_375._0.mu))*cos(_457000_375._0.theta)),(((focalLength_374*sinh_90(_457000_375._0.lambda))*sin(_457000_375._0.mu))*sin(_457000_375._0.theta)))};_E.Case('Line 456, Column 3')}()}),phaseCorrect_92=function(x_376){return function(){switch(x_376.ctor){case'::':switch(x_376._1.ctor){case'::':return((_N.cmp((x_376._1._0-x_376._0),pi).ctor==='GT')?_L.Cons((x_376._0+(2*pi)),phaseCorrect_92(x_376._1)):_L.Cons(x_376._0,phaseCorrect_92(x_376._1)))};break};return x_376}()},unsafeFind_93=F2(function(f_381,x_382){return function(){switch(x_382.ctor){case'::':return(f_381(x_382._0)?x_382._0:A2(unsafeFind_93,f_381,x_382._1))};_E.Case('Line 466, Column 3')}()}),findMatchingDistribution_94=F3(function(ds_385,bs_386,lvData_387){return function(){var dsName_388=fromString(function(){switch(ds_385.ctor){case'DETERMINE':return _str('DETERMINE');case'MESA':return _str('MESA')};_E.Case('Line 473, Column 28')}()),bsName_389=fromString(function(){switch(bs_386.ctor){case'AverageState':return _str('ED-ES');case'EndDiastole':return _str('ED');case'EndSystole':return _str('ES')};_E.Case('Line 476, Column 28')}());return A2(unsafeFind_93,function(d_390){return(_N.eq(d_390.dataset,dsName_388)&&_N.eq(d_390.biologicalState,bsName_389))},toList(lvData_387.distributions))}()}),lvJSONToModel_95=F4(function(resp_391,modeWeights_392,dataSet_393,biologicalState_394){return function(){switch(resp_391.ctor){case'Just':return function(){var trilinearLookupValue_404=F3(function(values_418,_507001_419,_507000_420){return function(){switch(_507001_419.ctor){case'ElementID':return function(){switch(_507000_420.ctor){case'TrilinearLocalNode':return A2(rawLookup_12,values_418,(((_507001_419._0-1)*nTrilinearLocalNodes_82)+(_507000_420._0-1)))};_E.Case('Line 507, Column 11')}()};_E.Case('Line 507, Column 11')}()}),bicubicLinearLookupValue_405=F3(function(values_423,_510001_424,_510000_425){return function(){switch(_510001_424.ctor){case'ElementID':return function(){switch(_510000_425.ctor){case'BicubicLinearLocalNode':return A2(rawLookup_12,values_423,(((_510001_424._0-1)*nBicubicLinearLocalNodes_81)+(_510000_425._0-1)))};_E.Case('Line 510, Column 11')}()};_E.Case('Line 510, Column 11')}()}),prolateCoords_409=F3(function(elid_428,surf_429,rnid_430){return function(){var xi_431=A2(refinedNodeToXiCoordinates_88,rnid_430,surf_429);return Prolate_71({_:{},lambda:A2(bicubicLinearInterpolate_16,lookupLambdaValue_406(elid_428),xi_431),mu:A2(trilinearInterpolate_15,lookupMuValue_407(elid_428),xi_431),theta:A2(trilinearInterpolate_15,lookupThetaValue_408(elid_428),xi_431)})}()}),rcCoords_410=F3(function(elID_432,surf_433,rnID_434){return A2(prolateToCartesian_91,A2(rawLookup_12,resp_391._0.distributions,0).averages.flength,A3(prolateCoords_409,elID_432,surf_433,rnID_434))}),elementPrims_411=F2(function(elID_435,surf_436){return function(){var nodeAt_438=F2(function(x_439,y_440){return A2(rawLookup_12,narray_437,((y_440*refineX_73)+x_439))}),narray_437=fromList(A2(map,A2(rcCoords_410,elID_435,surf_436),allRefinedNodes_85));return A2(concatMap,function(xlow_441){return A2(concatMap,function(ylow_442){return _J.toList([A3(Triangle_1,A2(nodeAt_438,xlow_441,ylow_442),A2(nodeAt_438,xlow_441,(ylow_442+1)),A2(nodeAt_438,(xlow_441+1),ylow_442)),A3(Triangle_1,A2(nodeAt_438,(xlow_441+1),ylow_442),A2(nodeAt_438,xlow_441,(ylow_442+1)),A2(nodeAt_438,(xlow_441+1),(ylow_442+1)))])},_L.range(0,(refineY_74-2)))},_L.range(0,(refineX_73-2)))}()}),distrib_396=A3(findMatchingDistribution_94,dataSet_393,biologicalState_394,resp_391._0),modes_397=toList(distrib_396.modes),globalLambdas_398=linearCombine_17(_L.Cons({_:{},mup:1.0,values:distrib_396.averages.lambdas},A3(zipWith,function(w_412){return function(m_413){return {_:{},mup:w_412,values:m_413.lambdas}}},modeWeights_392,modes_397))),globalMus_399=linearCombine_17(_L.Cons({_:{},mup:1.0,values:distrib_396.averages.mus},A3(zipWith,function(w_414){return function(m_415){return {_:{},mup:w_414,values:m_415.mus}}},modeWeights_392,modes_397))),globalThetas_400=linearCombine_17(_L.Cons({_:{},mup:1.0,values:distrib_396.averages.thetas},A3(zipWith,function(w_416){return function(m_417){return {_:{},mup:w_416,values:m_417.thetas}}},modeWeights_392,modes_397))),localLambdas_401=A2(linearRemapArray_14,resp_391._0.localToGlobalLambda,globalLambdas_398),localMus_402=A2(simpleRemapArray_13,resp_391._0.localToGlobalMuTheta,globalMus_399),localThetas_403=function(x){return fromList(phaseCorrect_92(toList(x)))}(A2(simpleRemapArray_13,resp_391._0.localToGlobalMuTheta,globalThetas_400)),lookupLambdaValue_406=bicubicLinearLookupValue_405(localLambdas_401),lookupMuValue_407=trilinearLookupValue_404(localMus_402),lookupThetaValue_408=trilinearLookupValue_404(localThetas_403);return GLPrimModel_7({_:{},primitives:A2(concatMap,function(surf_443){return A2(concatMap,function(elID_444){return A2(elementPrims_411,elID_444,surf_443)},allElements_86)},allSurfaces_87)})}();case'Nothing':return placeholderModel_40};_E.Case('Line 485, Column 3')}()}),labelSlider_101=F2(function(idx_449,sliderElem_450){return A2(beside,plainText(_L.append(_str('Mode '),_L.append(show(idx_449),_str(': ')))),sliderElem_450)}),makeSceneView_102=F2(function(primModelValue_451,cameraMatrixValue_452){return function(){var camPerspect_453=A2(multiply4x4_24,myPerspectiveMatrix_43,cameraMatrixValue_452),rotatedDiffuseDirection_454=vec4ToXYZ_20(A2(mat4x4xv_25,mat4ToInverseMat3_28(cameraMatrixValue_452),initialDiffuseDirection_77));return A4(glSceneObject_9,canvasWidth_75,canvasHeight_76,primModelValue_451,GLPrimSceneView_8({_:{},ambientColour:A3(GLColour_2,1,1,1),ambientIntensity:0.4,diffuseColour:A3(GLColour_2,1,1,1),diffuseDirection:rotatedDiffuseDirection_454,diffuseIntensity:0.3,projection:camPerspect_453}))}()}),glSceneObject_9=N.glSceneObject,sendRaw_10=NJSON.send,fastJSON_11=NJSON.fastJSON,rawLookup_12=NJSON.rawLookup,simpleRemapArray_13=NJSON.simpleRemapArray,linearRemapArray_14=NJSON.linearRemapArray,trilinearInterpolate_15=NJSON.trilinearInterpolate,bicubicLinearInterpolate_16=NJSON.bicubicLinearInterpolate,linearCombine_17=NJSON.linearCombine,slider_18=NSLIDE.slider,identity4x4_19=A4(Matrix4x4_4,A4(Vector4_3,1,0,0,0),A4(Vector4_3,0,1,0,0),A4(Vector4_3,0,0,1,0),A4(Vector4_3,0,0,0,1)),lowVal_36=-50,highVal_37=50,lowZ_38=-50,highZ_39=50,placeholderModel_40=function(){var quad_260=F4(function(a_261,b_262,c_263,d_264){return _J.toList([A3(Triangle_1,a_261,b_262,c_263),A3(Triangle_1,a_261,c_263,d_264)])}),clbf_252=A3(Coord3D_0,lowVal_36,lowVal_36,lowZ_38),crbf_253=A3(Coord3D_0,highVal_37,lowVal_36,lowZ_38),cltf_254=A3(Coord3D_0,lowVal_36,highVal_37,lowZ_38),crtf_255=A3(Coord3D_0,highVal_37,highVal_37,lowZ_38),clba_256=A3(Coord3D_0,lowVal_36,lowVal_36,highZ_39),crba_257=A3(Coord3D_0,highVal_37,lowVal_36,highZ_39),clta_258=A3(Coord3D_0,lowVal_36,highVal_37,highZ_39),crta_259=A3(Coord3D_0,highVal_37,highVal_37,highZ_39);return GLPrimModel_7({_:{},primitives:_L.append(A4(quad_260,clbf_252,crbf_253,crtf_255,cltf_254),_L.append(A4(quad_260,clba_256,clbf_252,cltf_254,clta_258),_L.append(A4(quad_260,crbf_253,crba_257,crta_259,crtf_255),_L.append(A4(quad_260,clba_256,clta_258,crta_259,crba_257),_L.append(A4(quad_260,cltf_254,crtf_255,crta_259,clta_258),_L.append(A4(quad_260,crbf_253,clbf_252,clba_256,crba_257),_J.toList([])))))))})}(),myFovRadians_41=(pi/4),myPerspectiveMatrix_43=A4(perspectiveMatrix_42,1.0e-2,1000,1,myFovRadians_41),initialCameraMoveState_49={_:{},cameraModifyMode:CameraRotate_46,cameraQuaternion:A4(Quaternion_6,1,0,0,0),cameraTransformation:A3(Vector3_5,0,0,-200),mainTouch:{_:{},id:0,t0:0,x:0,x0:0,y:0,y0:0},processedPosition:{ctor:"Tuple2",_0:0,_1:0},wasDragging:false},canvasTouches_51=A2(lift,filter(function(t_279){return((_N.cmp(t_279.x,canvasWidth_75).ctor==='LT')&&(_N.cmp(t_279.y,canvasHeight_76).ctor==='LT'))}),Touch.touches),cameraMoveState_52=A3(Signal.foldp,updateCameraMoveState_53,initialCameraMoveState_49,A5(Signal.lift4,function(v0_280){return function(v1_281){return function(v2_282){return function(v3_283){return {ctor:"Tuple4",_0:v0_280,_1:v1_281,_2:v2_282,_3:v3_283}}}}},Keyboard.shift,Keyboard.ctrl,Keyboard.keysDown,canvasTouches_51)),cameraMatrix_54=A2(lift,function(x_344){return A2(multiply4x4_24,vectorToTranslationMatrix_35(x_344.cameraTransformation),quaternionToRotationMatrix_29(x_344.cameraQuaternion))},cameraMoveState_52),refineX_73=6,refineY_74=6,canvasWidth_75=500,canvasHeight_76=500,initialDiffuseDirection_77=A4(Vector4_3,(0-0.3),(0-0.5),(0-0.8),1),lvJSON_78=A2(lift,responseToLVJSON_62,sendRaw_10(constant(Http.get(_str('LV.json'))))),nElements_80=16,nBicubicLinearLocalNodes_81=32,nTrilinearLocalNodes_82=8,allRefinedNodes_85=A2(map,RefinedNodeID_70,_L.range(1,(refineX_73*refineY_74))),allElements_86=A2(map,ElementID_65,_L.range(1,nElements_80)),allSurfaces_87=_J.toList([Endocardial_68,Epicardial_69]),modeWeights_96=A2(map,function(__445){return A6(slider_18,canvasWidth_75,8,(0-2.0),2.0,1.0e-2,0.0)},_L.range(1,6)),selectDataset_97=dropDown(_J.toList([{ctor:"Tuple2",_0:_str('DETERMINE (diseased hearts)'),_1:DETERMINE_55},{ctor:"Tuple2",_0:_str('MESA (healthy hearts)'),_1:MESA_56}])),selectBiologicalState_98=dropDown(_J.toList([{ctor:"Tuple2",_0:_str('End systole'),_1:EndSystole_58},{ctor:"Tuple2",_0:_str('End diastole'),_1:EndDiastole_57},{ctor:"Tuple2",_0:_str('Average'),_1:AverageState_59}])),primModel_99=A3(lift2,F2(function(f,x){return f(x)}),A3(lift2,F2(function(f,x){return f(x)}),A3(lift2,F2(function(f,x){return f(x)}),A2(lift,lvJSONToModel_95,lvJSON_78),combine(A2(map,snd,modeWeights_96))),snd(selectDataset_97)),snd(selectBiologicalState_98)),main_100=A2(lift,flow(down),combine(_L.Cons(A3(lift2,F2(function(f,x){return f(x)}),A2(lift,makeSceneView_102,primModel_99),cameraMatrix_54),_L.append(A2(map,function(_0_446){return function(){switch(_0_446.ctor){case'Tuple2':switch(_0_446._1.ctor){case'Tuple2':return A2(lift,labelSlider_101(_0_446._0),_0_446._1._0)};break};_E.Case('Line 570, Column 60')}()},A2(zip,_L.range(1,6),modeWeights_96)),_J.toList([constant(A2(spacer,1,80)),A2(lift,flow(right),combine(_J.toList([constant(A2(spacer,50,1)),fst(selectDataset_97),constant(A2(spacer,10,1)),fst(selectBiologicalState_98)])))])))));elm.Native=elm.Native||{};var _=elm.Native.Main||{};_.$op={};_.Coord3D=Coord3D_0;_.Triangle=Triangle_1;_.GLColour=GLColour_2;_.Vector4=Vector4_3;_.Matrix4x4=Matrix4x4_4;_.Vector3=Vector3_5;_.Quaternion=Quaternion_6;_.GLPrimModel=GLPrimModel_7;_.GLPrimSceneView=GLPrimSceneView_8;_.glSceneObject=glSceneObject_9;_.sendRaw=sendRaw_10;_.fastJSON=fastJSON_11;_.rawLookup=rawLookup_12;_.simpleRemapArray=simpleRemapArray_13;_.linearRemapArray=linearRemapArray_14;_.trilinearInterpolate=trilinearInterpolate_15;_.bicubicLinearInterpolate=bicubicLinearInterpolate_16;_.linearCombine=linearCombine_17;_.slider=slider_18;_.identity4x4=identity4x4_19;_.vec4ToXYZ=vec4ToXYZ_20;_.matrix4x4Row=matrix4x4Row_21;_.matrix4x4Column=matrix4x4Column_22;_.dotProduct=dotProduct_23;_.multiply4x4=multiply4x4_24;_.mat4x4xv=mat4x4xv_25;_.transpose4x4=transpose4x4_26;_.norm4=norm4_27;_.mat4ToInverseMat3=mat4ToInverseMat3_28;_.quaternionToRotationMatrix=quaternionToRotationMatrix_29;_.normaliseQuaternion=normaliseQuaternion_30;_.multiplyQuaternion=multiplyQuaternion_31;_.conjugateQuaternion=conjugateQuaternion_32;_.rotateVectorByQuaternion=rotateVectorByQuaternion_33;_.eulerToQuaternion=eulerToQuaternion_34;_.vectorToTranslationMatrix=vectorToTranslationMatrix_35;_.lowVal=lowVal_36;_.highVal=highVal_37;_.lowZ=lowZ_38;_.highZ=highZ_39;_.placeholderModel=placeholderModel_40;_.myFovRadians=myFovRadians_41;_.perspectiveMatrix=perspectiveMatrix_42;_.myPerspectiveMatrix=myPerspectiveMatrix_43;_.TranslateXY=TranslateXY_44;_.TranslateXZ=TranslateXZ_45;_.CameraRotate=CameraRotate_46;_.CameraTranslate=CameraTranslate_47;_.CameraMoveState=CameraMoveState_48;_.initialCameraMoveState=initialCameraMoveState_49;_.keyboardAlt=keyboardAlt_50;_.canvasTouches=canvasTouches_51;_.cameraMoveState=cameraMoveState_52;_.updateCameraMoveState=updateCameraMoveState_53;_.cameraMatrix=cameraMatrix_54;_.DETERMINE=DETERMINE_55;_.MESA=MESA_56;_.EndDiastole=EndDiastole_57;_.EndSystole=EndSystole_58;_.AverageState=AverageState_59;_.LVDistrib=LVDistrib_60;_.LVJSON=LVJSON_61;_.responseToLVJSON=responseToLVJSON_62;_.GlobalMuLambda=GlobalMuLambda_63;_.GlobalTheta=GlobalTheta_64;_.ElementID=ElementID_65;_.BicubicLinearLocalNode=BicubicLinearLocalNode_66;_.TrilinearLocalNode=TrilinearLocalNode_67;_.Endocardial=Endocardial_68;_.Epicardial=Epicardial_69;_.RefinedNodeID=RefinedNodeID_70;_.Prolate=Prolate_71;_.Xi=Xi_72;_.refineX=refineX_73;_.refineY=refineY_74;_.canvasWidth=canvasWidth_75;_.canvasHeight=canvasHeight_76;_.initialDiffuseDirection=initialDiffuseDirection_77;_.lvJSON=lvJSON_78;_.surfaceToFloat=surfaceToFloat_79;_.nElements=nElements_80;_.nBicubicLinearLocalNodes=nBicubicLinearLocalNodes_81;_.nTrilinearLocalNodes=nTrilinearLocalNodes_82;_.localNodeIndexBicubicLinear=localNodeIndexBicubicLinear_83;_.localNodeIndexTrilinear=localNodeIndexTrilinear_84;_.allRefinedNodes=allRefinedNodes_85;_.allElements=allElements_86;_.allSurfaces=allSurfaces_87;_.refinedNodeToXiCoordinates=refinedNodeToXiCoordinates_88;_.cosh=cosh_89;_.sinh=sinh_90;_.prolateToCartesian=prolateToCartesian_91;_.phaseCorrect=phaseCorrect_92;_.unsafeFind=unsafeFind_93;_.findMatchingDistribution=findMatchingDistribution_94;_.lvJSONToModel=lvJSONToModel_95;_.modeWeights=modeWeights_96;_.selectDataset=selectDataset_97;_.selectBiologicalState=selectBiologicalState_98;_.primModel=primModel_99;_.main=main_100;_.labelSlider=labelSlider_101;_.makeSceneView=makeSceneView_102;return elm.Main=_}</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>